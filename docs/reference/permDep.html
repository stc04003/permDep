<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Permutation test for general dependent truncation — permDep • permDep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Permutation test for general dependent truncation — permDep" />
<meta property="og:description" content="Perform permutation test based on conditional or unconditional approach." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">permDep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vig-permDep.html">Illustration of the `permDep` function</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/stc04003/permDep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation test for general dependent truncation</h1>
    <small class="dont-index">Source: <a href='http://github.com/stc04003/permDep/blob/master/R/depTrun.R'><code>R/depTrun.R</code></a></small>
    <div class="hidden name"><code>permDep.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform permutation test based on conditional or unconditional approach.</p>
    </div>

    <pre class="usage"><span class='fu'>permDep</span><span class='op'>(</span>
  <span class='va'>trun</span>,
  <span class='va'>obs</span>,
  <span class='va'>permSize</span>,
  <span class='va'>cens</span>,
  sampling <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"conditional"</span>, <span class='st'>"unconditional"</span>, <span class='st'>"is.conditional"</span>, <span class='st'>"is.unconditional"</span><span class='op'>)</span>,
  kendallOnly <span class='op'>=</span> <span class='cn'>FALSE</span>,
  minp1Only <span class='op'>=</span> <span class='cn'>FALSE</span>,
  minp2Only <span class='op'>=</span> <span class='cn'>FALSE</span>,
  nc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='fu'>detectCores</span><span class='op'>(</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  minp.eps <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot.int <span class='op'>=</span> <span class='cn'>FALSE</span>,
  anim_name <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>trun</th>
      <td><p>is the left truncation time.</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>is the observed failure time.</p></td>
    </tr>
    <tr>
      <th>permSize</th>
      <td><p>is the number of permutations.</p></td>
    </tr>
    <tr>
      <th>cens</th>
      <td><p>is the status indicator if the observed failure time are subjected to right-censoring; 0 = censored, 1 = event.</p></td>
    </tr>
    <tr>
      <th>sampling</th>
      <td><p>a character string specifying the sampling method used in permutation.
The following are permitted:</p><dl>
<dt><code>conditional</code></dt><dd><p>conditional permutation;</p></dd>
<dt><code>uconditional</code></dt><dd><p>unconditional permutation;</p></dd>
<dt><code>is.conditional</code></dt><dd><p>importance sampling version of conditional permutation;</p></dd>
<dt><code>is.uconditional</code></dt><dd><p>importance sampling version of unconditional permutation;</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>kendallOnly, minp1Only, minp2Only</th>
      <td><p>optional values indicating which test statistics to be used.
If all leave as <code>FALSE</code>, <code>permDep</code> will use all three test statistics in each permutation.</p></td>
    </tr>
    <tr>
      <th>nc</th>
      <td><p>is the number of cores used in permutation.
When <code>nc &gt; 1</code>, permutation is carried out with parallel computing.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>an optional vector containing random seeds to be used to generate permutation samples.
Random seeds will be used when left unspecified.</p></td>
    </tr>
    <tr>
      <th>minp.eps</th>
      <td><p>an optional value indicating the width of the intervals used in minp2 procedure.
The following input are allowed:</p><dl>
<dt>a single numerical number: </dt><dd><p>sets the common width for all intervals</p></dd>
<dt>a numerical vector: </dt><dd><p>the length of the vector needs to be a sub-multiple or
multiple of the number of uncensored events. This input is useful for user specified widths.</p></dd>
<dt>a character string: </dt><dd><p>This option can be either "in" or "out", which require the minimum number
of uncensored events inside or outside of each interval, respectively.</p></dd>
<dt>NULL: </dt><dd><p>automatic selection using the algorithm outlined in Chiou (2018) will be used.</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>plot.int</th>
      <td><p>an optional logical value indicating whether an
animated scatterplot will be produced
to how the minp intervals are chosen for the observed data.</p></td>
    </tr>
    <tr>
      <th>anim_name</th>
      <td><p>an optional character string specifying the file name that the animation to be saved.
When not specified, file name based on the current system date and time will be used.
This argument will only be executed when <code>plot.int = TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing output with the following components:</p><dl>
<dt>obsKen</dt><dd><p>the observed p-value using Kendall's tau test statistic.</p></dd>
<dt>obsP1</dt><dd><p>the observed p-value using minp1 test statistic.</p></dd>
<dt>obsP2</dt><dd><p>the observed p-value using minp2 test statistic.</p></dd>
<dt>obsTest1</dt><dd><p>the observed minp1 test statistic.</p></dd>
<dt>obsTest2</dt><dd><p>the observed minp2 test statistic.</p></dd>
<dt>permKen</dt><dd><p>Kendall's tau test statistics from permutation samples.</p></dd>
<dt>permP1</dt><dd><p>minp1 test statistics from permutation samples.</p></dd>
<dt>permP2</dt><dd><p>minp2 test statistics from permutation samples.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chiou, S.H., Qian, J., and Betensky, R.A. (2018).
Permutation Test for General Dependent Truncation.
<em>Computational Statistics \&amp; Data Analysis</em>,128, p308--324.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>simDat</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>k</span> <span class='op'>&lt;-</span> <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='va'>xx</span> <span class='op'>&lt;-</span> <span class='va'>yy</span> <span class='op'>&lt;-</span> <span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='va'>delta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='va'>n</span><span class='op'>)</span>
  <span class='kw'>while</span><span class='op'>(</span><span class='va'>k</span> <span class='op'>&lt;=</span> <span class='va'>n</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>tt</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>3.5</span><span class='op'>)</span>
    <span class='va'>xx</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1.95</span> <span class='op'>+</span> <span class='fl'>0.65</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>tt</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>-</span> <span class='fl'>1.25</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1</span>, sd <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
    <span class='va'>cc</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span>
    <span class='va'>delta</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>xx</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;=</span> <span class='va'>cc</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span><span class='op'>)</span>
    <span class='va'>yy</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>pmin</a></span><span class='op'>(</span><span class='va'>xx</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span>, <span class='va'>cc</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span><span class='op'>)</span>
    <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='va'>s</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>tt</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span> <span class='op'>&lt;=</span> <span class='va'>yy</span><span class='op'>[</span><span class='va'>k</span><span class='op'>]</span><span class='op'>)</span> <span class='va'>k</span> <span class='op'>=</span> <span class='va'>k</span><span class='op'>+</span><span class='fl'>1</span>
  <span class='op'>}</span>
 <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>trun <span class='op'>=</span> <span class='va'>tt</span>, obs <span class='op'>=</span> <span class='va'>yy</span>, delta <span class='op'>=</span> <span class='va'>delta</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>simDat</span><span class='op'>(</span><span class='fl'>50</span><span class='op'>)</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fl'>20</span>

<span class='co'>## Perform conditional permutation with Kendall's tau, minp1 and minp2</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fu'>permDep</span><span class='op'>(</span><span class='va'>trun</span>, <span class='va'>obs</span>, <span class='va'>B</span>, <span class='va'>delta</span>, nc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   1.608   0.020   1.630 </div><div class='input'><span class='va'>fit</span>
</div><div class='output co'>#&gt; 
#&gt;  Hypothesis test of quasi-independence based on conditional Kendall's tau statistics
#&gt;  Conditional permutation with size =  20 
#&gt;  p-value = 0.7143 
#&gt; 
#&gt;  Hypothesis test of quasi-independence based on minp1 statistics
#&gt;  Conditional permutation size =  20 
#&gt;  p-value = 0.0952 
#&gt; 
#&gt;  Hypothesis test of quasi-independence based on minp2 statistics
#&gt;  Conditional permutation size =  20 
#&gt;  p-value = 0.1429 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sy Han (Steven) Chiou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


