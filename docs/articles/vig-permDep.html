<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Permutation tests for general dependent truncation – illustration of the <code>permDep</code> function • permDep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Permutation tests for general dependent truncation – illustration of the &lt;code&gt;permDep&lt;/code&gt; function">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">permDep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vig-permDep.html">Permutation tests for general dependent truncation -- illustration of the `permDep` function</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stc04003/permDep">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Permutation tests for general dependent truncation – illustration of the <code>permDep</code> function</h1>
                        <h4 class="author">Sy Han (Steven) Chiou</h4>
            
            <h4 class="date">2019-08-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stc04003/permDep/blob/master/vignettes/vig-permDep.Rmd"><code>vignettes/vig-permDep.Rmd</code></a></small>
      <div class="hidden name"><code>vig-permDep.Rmd</code></div>

    </div>

    
    
<div id="objective" class="section level2">
<h2 class="hasAnchor">
<a href="#objective" class="anchor"></a>Objective</h2>
<p>In this vignette, we demonstrate the usage of the <code>permDep</code> function.</p>
</div>
<div id="generating-truncated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-truncated-data" class="anchor"></a>Generating truncated data</h2>
<p>We define the following functions to generate survival data with dependent left-truncation.</p>
<p>In the first setting, we generate the survival time from a Weibull distribution with shape parameter 3 and scale parameter 8.5 and generate the truncation time from an exponential with mean 5. The dependence between the survival time and the truncation time is controlled by a normal copula from the <code>copula</code> package with a pre-specified pre-truncation unconditional Kendall’s tau (<code>tau</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(copula)
<span class="op">&gt;</span><span class="st"> </span>simDat1 &lt;-<span class="st"> </span><span class="cf">function</span>(n, tau) {
<span class="op">+</span><span class="st">     </span>k &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="op">+</span><span class="st">     </span>tt &lt;-<span class="st"> </span>xx &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="op">-</span><span class="dv">1</span>, n)
<span class="op">+</span><span class="st">     </span>kt &lt;-<span class="st"> </span><span class="kw">iTau</span>(<span class="kw">normalCopula</span>(), tau)
<span class="op">+</span><span class="st">     </span>cp &lt;-<span class="st"> </span><span class="kw">normalCopula</span>(kt, <span class="dt">dim =</span> <span class="dv">2</span>)
<span class="op">+</span><span class="st">     </span>dist &lt;-<span class="st"> </span><span class="kw">mvdc</span>(cp, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"exp"</span>, <span class="st">"weibull"</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">rate =</span> <span class="fl">0.2</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">scale =</span> <span class="fl">8.5</span>)))  
<span class="op">+</span><span class="st">     </span><span class="cf">while</span>(k <span class="op">&lt;=</span><span class="st"> </span>n){
<span class="op">+</span><span class="st">         </span>dat &lt;-<span class="st"> </span><span class="kw">rMvdc</span>(<span class="dv">1</span>, dist)
<span class="op">+</span><span class="st">         </span>tt[k] &lt;-<span class="st"> </span>dat[<span class="dv">1</span>]
<span class="op">+</span><span class="st">         </span>xx[k] &lt;-<span class="st"> </span>dat[<span class="dv">2</span>]
<span class="op">+</span><span class="st">         </span><span class="cf">if</span>(tt[k] <span class="op">&lt;=</span><span class="st"> </span>xx[k]) k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
<span class="op">+</span><span class="st">     </span>}     
<span class="op">+</span><span class="st">     </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Trun =</span> tt, <span class="dt">Time =</span> xx)
<span class="op">+</span><span class="st"> </span>}</code></pre></div>
<p>The <code>simDat1</code> funciton generates monotone dependence model and is used in <span class="citation">Chiou et al. (2018)</span> in the absence of censoring. The following scatterplots confirms the monotonic dependence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gridExtra)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)
<span class="op">&gt;</span><span class="st"> </span>tmp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>, <span class="cf">function</span>(x) 
<span class="op">+</span><span class="st">   </span><span class="kw">qplot</span>(Trun, Time, <span class="dt">data =</span> <span class="kw">simDat1</span>(<span class="dv">100</span>, x), <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Tau = "</span>, x)))
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/do.call">do.call</a></span>(<span class="st">"grid.arrange"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(tmp, <span class="dt">ncol =</span> <span class="dv">3</span>))</code></pre></div>
<p><img src="vig-permDep_files/figure-html/sim1-plot-1.png" width="700"></p>
<p>In the second setting, we consider a scenario with non-monotonic dependence between the survival time and the truncation time. We used a normal copula to specify the joint distribution of <span class="math inline">\((X, |T- 0.5|)\)</span>, where <span class="math inline">\(X\)</span> is the survival time and <span class="math inline">\(T\)</span> is the truncation time. We generate <span class="math inline">\(X\)</span> from a Weibull distribution with shape parameter 1 and scale parameter 4, and generate <span class="math inline">\(T\)</span> from a uniform distribution between 0 and 1. This implies that the pre-truncation unconditional Kendall’s taus have different signs for <span class="math inline">\(T &lt; 0.5\)</span> and <span class="math inline">\(T\ge0.5\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>simDat2 &lt;-<span class="st"> </span><span class="cf">function</span>(n, tau) {
<span class="op">+</span><span class="st">     </span>k &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="op">+</span><span class="st">     </span>tt &lt;-<span class="st"> </span>xx &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="op">-</span><span class="dv">1</span>, n)
<span class="op">+</span><span class="st">     </span>kt &lt;-<span class="st"> </span><span class="kw">iTau</span>(<span class="kw">normalCopula</span>(), tau)
<span class="op">+</span><span class="st">     </span>cp &lt;-<span class="st"> </span><span class="kw">normalCopula</span>(kt, <span class="dt">dim =</span> <span class="dv">2</span>)
<span class="op">+</span><span class="st">     </span>dist &lt;-<span class="st"> </span><span class="kw">mvdc</span>(cp, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"unif"</span>, <span class="st">"weibull"</span>),
<span class="op">+</span><span class="st">                  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">4</span>)))
<span class="op">+</span><span class="st">     </span><span class="cf">while</span>(k <span class="op">&lt;=</span><span class="st"> </span>n){
<span class="op">+</span><span class="st">         </span>tmp &lt;-<span class="st"> </span><span class="kw">rMvdc</span>(<span class="dv">1</span>, dist)
<span class="op">+</span><span class="st">         </span><span class="cf">if</span> (k <span class="op">&lt;=</span><span class="st"> </span>n<span class="op">/</span><span class="dv">2</span>) tt[k] &lt;-<span class="st"> </span>tmp[<span class="dv">1</span>]
<span class="op">+</span><span class="st">         </span><span class="cf">if</span> (k <span class="op">&gt;</span><span class="st"> </span>n<span class="op">/</span><span class="dv">2</span>) tt[k] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>tmp[<span class="dv">1</span>]
<span class="op">+</span><span class="st">         </span>xx[k] &lt;-<span class="st"> </span>tmp[<span class="dv">2</span>]
<span class="op">+</span><span class="st">         </span><span class="cf">if</span>(tt[k] <span class="op">&lt;=</span><span class="st"> </span>xx[k]) k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
<span class="op">+</span><span class="st">     </span>}
<span class="op">+</span><span class="st">     </span>dat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Trun =</span> tt, <span class="dt">Time =</span> xx)
<span class="op">+</span><span class="st">     </span>dat
<span class="op">+</span><span class="st"> </span>}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)
<span class="op">&gt;</span><span class="st"> </span>tmp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>, <span class="cf">function</span>(x) 
<span class="op">+</span><span class="st">   </span><span class="kw">qplot</span>(Trun, Time, <span class="dt">data =</span> <span class="kw">simDat2</span>(<span class="dv">100</span>, x), <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Tau = "</span>, x)))
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/do.call">do.call</a></span>(<span class="st">"grid.arrange"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(tmp, <span class="dt">ncol =</span> <span class="dv">3</span>))</code></pre></div>
<p><img src="vig-permDep_files/figure-html/sim2-plot-1.png" width="700"></p>
</div>
<div id="the-permdep-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-permdep-function" class="anchor"></a>The <code>permDep</code> function</h2>
<p>The arguments of <code>permDep</code> are as follow</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/args">args</a></span>(permDep)
<span class="cf">function</span> (trun, obs, permSize, cens, <span class="dt">sampling =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"conditional"</span>, 
    <span class="st">"unconditional"</span>, <span class="st">"is.conditional"</span>, <span class="st">"is.unconditional"</span>), <span class="dt">kendallOnly =</span> <span class="ot">FALSE</span>, 
    <span class="dt">minp1Only =</span> <span class="ot">FALSE</span>, <span class="dt">minp2Only =</span> <span class="ot">FALSE</span>, <span class="dt">nc =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">ceiling</a></span>(<span class="kw">detectCores</span>()<span class="op">/</span><span class="dv">2</span>), 
    <span class="dt">seed =</span> <span class="ot">NULL</span>, <span class="dt">minp.eps =</span> <span class="ot">NULL</span>, <span class="dt">plot.int =</span> <span class="ot">FALSE</span>, <span class="dt">anim_name =</span> <span class="ot">NULL</span>) 
<span class="ot">NULL</span></code></pre></div>
<p>The arguments are</p>
<ul>
<li>
<code>trun</code> is the left truncation time</li>
<li>
<code>obs</code> is the observed failure time; this is defined to be the minimum of the survival time and censoring time In addition, this is required to be greater than the truncation time</li>
<li>
<code>permSize</code> is the number of permutations</li>
<li>
<code>cens</code> is the status indicator; 0 = censored, 1 = event</li>
<li>
<code>sampling</code> is a character string specifying the sampling method used in permutation. The following are permitted.</li>
<li>
<code>conditional</code> conditional permutation</li>
<li>
<code>unconditional</code> unconditional permutation</li>
<li>
<code>is.conditional</code> importance sampling version of the conditional permutation (under development)</li>
<li>
<code>is.unconditional</code> importance sampling version of the unconditional permutation (under development)</li>
<li>
<code>kendallOnly</code> is a logical value indicating whether to use the conditional Kendall’s tau as the only test statistics</li>
<li>
<code>minp1Only</code> is a logical value indicating whether to use the minp1 test as the only test statistics</li>
<li>
<code>minp2Only</code> is a logical value indicating whether to use the minp2 test as the only test statistics</li>
<li>The default is to use all three test statistics (conditional Kendall’s tau, minp1, and minp2)</li>
<li>
<code>nc</code> is the number of cores used in the permutation test. When <code>nc &gt; 1</code>, permutation is carried out with parallel computing methods. The default is to use half of the available number of CPU cores on the current host.</li>
<li>
<code>seed</code> is an optional vector containing random seeds to be used to generate permutation samples. Random seeds will be used when left unspecified.</li>
<li>
<code>minp.eps</code> is an optional value indicating the width of the intervals used in minp2 procedure. The following are permitted.</li>
<li>
<em>a single numerical number</em> sets the common width for all intervals</li>
<li>
<em>a numerical vector</em> uses user specified width for the intervals. The length of the vector needs to be a sub-multiple or multiple of the number of uncensored events.</li>
<li>
<em>a character string</em> uses the pre-implemented algorithm to calculate the width of the intervals. This option can be either “in” or “out”, which require the minimum number of uncensored events inside or outside of each interval, respectively.</li>
<li>
<code>NULL</code> uses the automatic selection algorithm outlined in <span class="citation">Chiou et al. (2018)</span>
</li>
<li>
<code>plot.int</code> is a logical value indicating whether to plot the intervals when applying the minp tests. This is more useful when only one of <code>minp1Only</code> and <code>minp2Only</code> is <code>TRUE</code>.</li>
</ul>
<p>We will illustrate the usage of <code>permDep</code> with simulated data generated from <code>simDat1</code> and <code>simDat2</code>.</p>
</div>
<div id="permutation-test" class="section level2">
<h2 class="hasAnchor">
<a href="#permutation-test" class="anchor"></a>Permutation test</h2>
<p>We first use a small sample size example to demonstrate the different features.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)
<span class="op">&gt;</span><span class="st"> </span>dat &lt;-<span class="st"> </span><span class="kw">simDat1</span>(<span class="dv">30</span>, <span class="fl">.9</span>) ## highly correlated data</code></pre></div>
<div id="with-or-without-parallel-computing" class="section level3">
<h3 class="hasAnchor">
<a href="#with-or-without-parallel-computing" class="anchor"></a>With or without parallel computing</h3>
<p>Note that the computation time depends on the machine setting in the current host.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>parallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parallel/topics/detectCores">detectCores</a></span>()
[<span class="dv">1</span>] <span class="dv">8</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>);<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(f1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">nc =</span> <span class="dv">1</span>))
   user  system elapsed 
 <span class="fl">19.632</span>   <span class="fl">0.005</span>  <span class="fl">19.635</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>);<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(f2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">nc =</span> parallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parallel/topics/detectCores">detectCores</a></span>()))
   user  system elapsed 
  <span class="fl">0.072</span>   <span class="fl">0.076</span>  <span class="fl">11.496</span> 
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/identical">identical</a></span>(f1, f2)
[<span class="dv">1</span>] <span class="ot">TRUE</span>
<span class="op">&gt;</span><span class="st"> </span>f1

 Hypothesis test of quasi<span class="op">-</span>independence based on conditional Kendall<span class="st">'s tau statistics</span>
<span class="st"> Conditional permutation with size =  500 </span>
<span class="st"> p-value = 0.0020 </span>

<span class="st"> Hypothesis test of quasi-independence based on minp1 statistics</span>
<span class="st"> Conditional permutation size =  500 </span>
<span class="st"> p-value = 0.0020 </span>

<span class="st"> Hypothesis test of quasi-independence based on minp2 statistics</span>
<span class="st"> Conditional permutation size =  500 </span>
<span class="st"> p-value = 0.0060 </span></code></pre></div>
<p>Computation time is faster with parallel computation, e.g., <code>f2</code>, but using 8 does not make the program run 8 faster.</p>
</div>
<div id="different-minp-eps-options" class="section level3">
<h3 class="hasAnchor">
<a href="#different-minp-eps-options" class="anchor"></a>Different <code>minp.eps</code> options</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp2Only =</span> <span class="ot">TRUE</span>)<span class="op">$</span>p.valueMinp2
[<span class="dv">1</span>] <span class="fl">0.005988024</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp2Only =</span> <span class="ot">TRUE</span>, <span class="dt">minp.eps =</span> <span class="fl">0.5</span>)<span class="op">$</span>p.valueMinp2
[<span class="dv">1</span>] <span class="fl">0.01197605</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp2Only =</span> <span class="ot">TRUE</span>, <span class="dt">minp.eps =</span> <span class="st">"in"</span>)<span class="op">$</span>p.valueMinp2
[<span class="dv">1</span>] <span class="fl">0.001996008</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp2Only =</span> <span class="ot">TRUE</span>, <span class="dt">minp.eps =</span> <span class="st">"out"</span>)<span class="op">$</span>p.valueMinp2
[<span class="dv">1</span>] <span class="fl">0.001996008</span></code></pre></div>
<p>The performance of the minp2 test depends on the specification of the interval width (e.g., <code>minp.esp</code>), however, the resulting <span class="math inline">\(p\)</span>-values from the above example are significant at <span class="math inline">\(\alpha = 0.05\)</span>.</p>
</div>
</div>
<div id="track-intervals-from-minp-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#track-intervals-from-minp-tests" class="anchor"></a>Track intervals from minp tests</h2>
<p>Enabling <code>plot.int</code> allows users to visualize the intervals used in computing the log-rank statistics when applying the minp1 and the minp2 tests on the observed data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp1Only =</span> <span class="ot">TRUE</span>, 
<span class="op">+</span><span class="st">         </span><span class="dt">plot.int =</span> <span class="ot">TRUE</span>, <span class="dt">anim_name =</span> <span class="st">"vig-minp1"</span>)

 Hypothesis test of quasi<span class="op">-</span>independence based on minp1 statistics
 Conditional permutation size =<span class="st">  </span><span class="dv">500</span> 
 p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.0020</span> 

 Hypothesis test of quasi<span class="op">-</span>independence based on minp2 statistics
 Conditional permutation size =<span class="st">  </span><span class="dv">500</span> 
 p<span class="op">-</span>value =<span class="st"> </span><span class="ot">NA</span> </code></pre></div>
<div class="figure">
<img src="vig-minp1.gif">
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp2Only =</span> <span class="ot">TRUE</span>, 
<span class="op">+</span><span class="st">         </span><span class="dt">plot.int =</span> <span class="ot">TRUE</span>, <span class="dt">anim_name =</span> <span class="st">"vig-minp2"</span>)</code></pre></div>
<div class="figure">
<img src="vig-minp2.gif">
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/permDep.html">permDep</a></span>(dat<span class="op">$</span>Trun, dat<span class="op">$</span>Time, <span class="dv">500</span>, <span class="dt">minp2Only =</span> <span class="ot">TRUE</span>, <span class="dt">minp.eps =</span> <span class="st">"in"</span>,
<span class="op">+</span><span class="st">         </span><span class="dt">plot.int =</span> <span class="ot">TRUE</span>, <span class="dt">anim_name =</span> <span class="st">"vig-minp2-2"</span>)</code></pre></div>
<div class="figure">
<img src="vig-minp2-2.gif">
</div>
</div>
<div id="reference" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h2>
<div id="refs" class="references">
<div id="ref-chiou2018permutation">
<p>Chiou, Sy Han, Jing Qian, Elizabeth Mormino, Rebecca A Betensky, Lifestyle Flagship Study of Aging, Harvard Aging Brain Study, Alzheimer’s Disease Neuroimaging Initiative, and others. 2018. “Permutation Tests for General Dependent Truncation.” <em>Computational Statistics &amp; Data Analysis</em> 128. Elsevier: 308–24.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#objective">Objective</a></li>
      <li><a href="#generating-truncated-data">Generating truncated data</a></li>
      <li><a href="#the-permdep-function">The <code>permDep</code> function</a></li>
      <li><a href="#permutation-test">Permutation test</a></li>
      <li><a href="#track-intervals-from-minp-tests">Track intervals from minp tests</a></li>
      <li><a href="#reference">Reference</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sy Han (Steven) Chiou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
